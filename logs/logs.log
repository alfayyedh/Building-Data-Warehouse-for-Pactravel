2025-01-16 21:53:54,446 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-16 21:53:54,588 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-16 21:53:54,606 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-16 21:53:54,618 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-16 21:53:54,631 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-16 21:53:54,656 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-16 21:53:54,849 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-16 21:53:54,863 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-16 21:53:54,863 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-16 21:53:54,867 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-16 21:53:54,867 - INFO - [pid 62742] Worker Worker(salt=3184285618, workers=1, host=MSI, username=alfayyedh, pid=62742) done      Extract()
2025-01-16 21:53:54,869 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 21:53:54,877 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-16 21:53:54,878 - DEBUG - Asking scheduler for work...
2025-01-16 21:53:54,884 - DEBUG - Pending tasks: 2
2025-01-16 21:53:54,885 - INFO - [pid 62742] Worker Worker(salt=3184285618, workers=1, host=MSI, username=alfayyedh, pid=62742) running   Load()
2025-01-16 21:53:54,892 - INFO - Read Load Query - SUCCESS!
2025-01-16 21:53:54,931 - INFO - Read Extracted Data - SUCCESS!
2025-01-16 21:53:54,932 - INFO - Connect to DWH - SUCCESS!
2025-01-16 21:53:54,932 - ERROR - Truncate public Schema in DWH - FAILED!
2025-01-16 21:53:55,023 - ERROR - [pid 62742] Worker Worker(salt=3184285618, workers=1, host=MSI, username=alfayyedh, pid=62742) failed    Load()
Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/load.py", line 120, in run
    truncate_query = truncate_query.split(';')
AttributeError: 'NoneType' object has no attribute 'split'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/load.py", line 144, in run
    raise Exception("Failed to Truncate public Schema in DWH!")
Exception: Failed to Truncate public Schema in DWH!
2025-01-16 21:53:55,069 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 21:53:55,078 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-01-16 21:53:55,079 - DEBUG - Asking scheduler for work...
2025-01-16 21:53:55,087 - DEBUG - Done
2025-01-16 21:53:55,087 - DEBUG - There are no more tasks to run at this time
2025-01-16 21:53:55,088 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-01-16 21:53:55,088 - DEBUG - There are 2 pending tasks unique to this worker
2025-01-16 21:53:55,088 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-01-16 21:53:55,088 - INFO - Worker Worker(salt=3184285618, workers=1, host=MSI, username=alfayyedh, pid=62742) was stopped. Shutting down Keep-Alive thread
2025-01-16 21:53:55,096 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 ran successfully:
    - 1 Extract()
* 1 failed:
    - 1 Load()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-01-16 21:57:24,063 - INFO - Read Load Query - SUCCESS!
2025-01-16 21:57:24,155 - INFO - Read Extracted Data - SUCCESS!
2025-01-16 21:57:24,202 - INFO - Connect to DWH - SUCCESS!
2025-01-16 21:57:24,433 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-16 21:57:24,434 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-16 21:57:24,515 - INFO - Load aircrafts table - SUCCESS!
2025-01-16 21:57:24,569 - INFO - Load airlines table - SUCCESS!
2025-01-16 21:57:24,585 - INFO - Load airports table - SUCCESS!
2025-01-16 21:57:24,672 - INFO - Load customers table - SUCCESS!
2025-01-16 21:57:24,947 - INFO - Load hotel table - SUCCESS!
2025-01-16 21:57:26,257 - INFO - Load flight_bookings table - SUCCESS!
2025-01-16 21:57:26,274 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-16 21:57:26,274 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-16 21:57:26,275 - ERROR - LOAD All Tables To Pactravel Staging - FAILED
2025-01-16 21:57:26,355 - ERROR - LOAD All Tables To Pactravel DWH - FAILED
2025-01-16 21:57:26,358 - ERROR - [pid 64835] Worker Worker(salt=5891835528, workers=1, host=MSI, username=alfayyedh, pid=64835) failed    Load()
Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/load.py", line 244, in run
    query = sqlalchemy.text(query)
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/sqlalchemy/sql/_elements_constructors.py", line 1640, in text
    return TextClause(text)
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 2295, in __init__
    self.text = self._bind_params_regex.sub(repl, text)
TypeError: expected string or bytes-like object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/load.py", line 256, in run
    raise Exception('Failed Load Tables To Pactravel Staging')
Exception: Failed Load Tables To Pactravel Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/load.py", line 296, in run
    raise Exception('Failed Load Tables To Pactravel DWH')
Exception: Failed Load Tables To Pactravel DWH
2025-01-16 21:57:26,389 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 21:57:26,394 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-01-16 21:57:26,394 - DEBUG - Asking scheduler for work...
2025-01-16 21:57:26,398 - DEBUG - Done
2025-01-16 21:57:26,399 - DEBUG - There are no more tasks to run at this time
2025-01-16 21:57:26,399 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-01-16 21:57:26,399 - DEBUG - There are 2 pending tasks unique to this worker
2025-01-16 21:57:26,399 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-01-16 21:57:26,399 - INFO - Worker Worker(salt=5891835528, workers=1, host=MSI, username=alfayyedh, pid=64835) was stopped. Shutting down Keep-Alive thread
2025-01-16 21:57:26,401 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-01-16 23:08:34,088 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-16 23:08:34,256 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-16 23:08:34,294 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-16 23:08:34,307 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-16 23:08:34,335 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-16 23:08:34,368 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-16 23:08:34,477 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-16 23:08:34,486 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-16 23:08:34,486 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-16 23:08:34,497 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-16 23:08:34,497 - INFO - [pid 105995] Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) done      Extract()
2025-01-16 23:08:34,498 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:08:34,502 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-16 23:08:34,502 - DEBUG - Asking scheduler for work...
2025-01-16 23:08:34,505 - DEBUG - Pending tasks: 2
2025-01-16 23:08:34,505 - INFO - [pid 105995] Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) running   Load()
2025-01-16 23:08:34,508 - INFO - Read Load Query - SUCCESS!
2025-01-16 23:08:34,544 - INFO - Read Extracted Data - SUCCESS!
2025-01-16 23:08:34,544 - INFO - Connect to DWH - SUCCESS!
2025-01-16 23:08:34,678 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-16 23:08:34,678 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-16 23:08:34,712 - INFO - Load aircrafts table - SUCCESS!
2025-01-16 23:08:34,757 - INFO - Load airlines table - SUCCESS!
2025-01-16 23:08:34,773 - INFO - Load airports table - SUCCESS!
2025-01-16 23:08:34,818 - INFO - Load customers table - SUCCESS!
2025-01-16 23:08:34,933 - INFO - Load hotel table - SUCCESS!
2025-01-16 23:08:35,770 - INFO - Load flight_bookings table - SUCCESS!
2025-01-16 23:08:35,790 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-16 23:08:35,790 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-16 23:08:36,390 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2025-01-16 23:08:36,391 - INFO - ==================================ENDING LOAD DATA=======================================
2025-01-16 23:08:36,392 - INFO - [pid 105995] Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) done      Load()
2025-01-16 23:08:36,392 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:08:36,396 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-01-16 23:08:36,396 - DEBUG - Asking scheduler for work...
2025-01-16 23:08:36,399 - DEBUG - Pending tasks: 1
2025-01-16 23:08:36,399 - INFO - [pid 105995] Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) running   Transform()
2025-01-16 23:08:36,400 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m15:08:39  Running with dbt=1.9.1
[0m15:08:42  Installing dbt-labs/dbt_utils
[0m15:08:42  Installed from version 1.1.1
[0m15:08:42  Updated version available: 1.3.0
[0m15:08:42  Installing calogica/dbt_date
[0m15:08:43  Installed from version 0.10.0
[0m15:08:43  Updated version available: 0.10.1
[0m15:08:43  Installing calogica/dbt_expectations
[0m15:08:45  Installed from version 0.10.3
[0m15:08:45  Updated version available: 0.10.4
[0m15:08:45  Installing Snowflake-Labs/dbt_constraints
[0m15:08:46  Installed from version 0.6.3
[0m15:08:46  Updated version available: 1.0.4
[0m15:08:46  
[0m15:08:46  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'calogica/dbt_expectations', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m15:08:50  Running with dbt=1.9.1
[0m15:08:51  Registered adapter: postgres=1.8.2
[0m15:08:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:08:54  [[33mWARNING[0m]: 'dim_date' is a seed node, but it is specified in the models section of
models/marts/core/_core__models.yml. To fix this error, place the `dim_date`
specification under the seeds key instead.
[0m15:08:54  [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_daily_revenue' in the 'models' section of file 'models/marts/core/_core__models.yml'
[0m15:08:55  [[33mWARNING[0m]: Test 'test.pactravel.not_null_fct_daily_revenue_booking_date.72dda05237' (models/marts/core/_core__models.yml) depends on a node named 'fct_daily_revenue' in package '' which was not found
[0m15:08:55  [[33mWARNING[0m]: Test 'test.pactravel.dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_.4c0b38d195' (models/marts/core/_core__models.yml) depends on a node named 'fct_daily_revenue' in package '' which was not found
[0m15:08:55  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:08:55  
[0m15:08:55  Concurrency: 1 threads (target='dev')
[0m15:08:55  
[0m15:08:56  1 of 1 START seed file final.dim_date .......................................... [RUN]
[0m15:11:31  1 of 1 OK loaded seed file final.dim_date ...................................... [[32mINSERT 29220[0m in 155.58s]
[0m15:11:31  
[0m15:11:31  Running dbt Constraints
[0m15:11:31  Finished dbt Constraints
[0m15:11:31  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:11:31  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.07s]
[0m15:11:31  
[0m15:11:31  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 36.34 seconds (156.34s).
[0m15:11:32  
[0m15:11:32  [32mCompleted successfully[0m
[0m15:11:32  
[0m15:11:32  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:11:36  Running with dbt=1.9.1
[0m15:11:37  Registered adapter: postgres=1.8.2
[0m15:11:37  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:11:37  
[0m15:11:37  Concurrency: 1 threads (target='dev')
[0m15:11:37  
[0m15:11:38  1 of 15 START sql view model final.stg_pactravel__aircrafts .................... [RUN]
[0m15:11:38  1 of 15 OK created sql view model final.stg_pactravel__aircrafts ............... [[32mCREATE VIEW[0m in 0.20s]
[0m15:11:38  2 of 15 START sql view model final.stg_pactravel__airlines ..................... [RUN]
[0m15:11:38  2 of 15 OK created sql view model final.stg_pactravel__airlines ................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:11:38  3 of 15 START sql view model final.stg_pactravel__airports ..................... [RUN]
[0m15:11:38  3 of 15 OK created sql view model final.stg_pactravel__airports ................ [[32mCREATE VIEW[0m in 0.06s]
[0m15:11:38  4 of 15 START sql view model final.stg_pactravel__customers .................... [RUN]
[0m15:11:38  4 of 15 OK created sql view model final.stg_pactravel__customers ............... [[32mCREATE VIEW[0m in 0.06s]
[0m15:11:38  5 of 15 START sql view model final.stg_pactravel__flight_bookings .............. [RUN]
[0m15:11:38  5 of 15 OK created sql view model final.stg_pactravel__flight_bookings ......... [[32mCREATE VIEW[0m in 0.06s]
[0m15:11:38  6 of 15 START sql view model final.stg_pactravel__hotel ........................ [RUN]
[0m15:11:38  6 of 15 OK created sql view model final.stg_pactravel__hotel ................... [[32mCREATE VIEW[0m in 0.06s]
[0m15:11:38  7 of 15 START sql view model final.stg_pactravel__hotel_bookings ............... [RUN]
[0m15:11:38  7 of 15 OK created sql view model final.stg_pactravel__hotel_bookings .......... [[32mCREATE VIEW[0m in 0.06s]
[0m15:11:38  8 of 15 START sql table model final.dim_aircrafts .............................. [RUN]
[0m15:11:38  8 of 15 OK created sql table model final.dim_aircrafts ......................... [[32mSELECT 246[0m in 0.13s]
[0m15:11:38  9 of 15 START sql table model final.dim_airlines ............................... [RUN]
[0m15:11:38  9 of 15 OK created sql table model final.dim_airlines .......................... [[32mSELECT 1251[0m in 0.18s]
[0m15:11:38  10 of 15 START sql table model final.dim_airports .............................. [RUN]
[0m15:11:39  10 of 15 OK created sql table model final.dim_airports ......................... [[32mSELECT 105[0m in 0.08s]
[0m15:11:39  11 of 15 START sql table model final.dim_customers ............................. [RUN]
[0m15:11:39  11 of 15 OK created sql table model final.dim_customers ........................ [[32mSELECT 1000[0m in 0.07s]
[0m15:11:39  12 of 15 START sql table model final.dim_hotel ................................. [RUN]
[0m15:11:39  12 of 15 OK created sql table model final.dim_hotel ............................ [[32mSELECT 1470[0m in 0.07s]
[0m15:11:39  13 of 15 START sql table model final.fct_daily_bookings ........................ [RUN]
[0m15:11:39  13 of 15 OK created sql table model final.fct_daily_bookings ................... [[32mSELECT 0[0m in 0.07s]
[0m15:11:39  14 of 15 START sql table model final.fct_flight_bookings ....................... [RUN]
[0m15:11:39  14 of 15 OK created sql table model final.fct_flight_bookings .................. [[32mSELECT 8190[0m in 0.64s]
[0m15:11:39  15 of 15 START sql table model final.fct_hotel_bookings ........................ [RUN]
[0m15:11:40  15 of 15 OK created sql table model final.fct_hotel_bookings ................... [[32mSELECT 217[0m in 0.94s]
[0m15:11:40  
[0m15:11:40  Running dbt Constraints
[0m15:11:41  Finished dbt Constraints
[0m15:11:41  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:11:41  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.11s]
[0m15:11:41  
[0m15:11:41  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m15:11:41  
[0m15:11:41  [32mCompleted successfully[0m
[0m15:11:41  
[0m15:11:41  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m15:11:46  Running with dbt=1.9.1
[0m15:11:46  Registered adapter: postgres=1.8.2
[0m15:11:47  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:11:47  
[0m15:11:47  Concurrency: 1 threads (target='dev')
[0m15:11:47  
[0m15:11:47  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m15:11:47  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mSELECT 1251[0m in 0.17s]
[0m15:11:47  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m15:11:47  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mSELECT 1000[0m in 0.05s]
[0m15:11:47  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m15:11:47  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mSELECT 1470[0m in 0.05s]
[0m15:11:47  
[0m15:11:47  Running dbt Constraints
[0m15:11:47  Finished dbt Constraints
[0m15:11:47  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:11:47  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m15:11:47  
[0m15:11:47  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m15:11:47  
[0m15:11:47  [32mCompleted successfully[0m
[0m15:11:47  
[0m15:11:47  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:11:51  Running with dbt=1.9.1
[0m15:11:51  Registered adapter: postgres=1.8.2
[0m15:11:52  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:11:52  
[0m15:11:52  Concurrency: 1 threads (target='dev')
[0m15:11:52  
[0m15:11:52  1 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m15:11:53  1 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.07s]
[0m15:11:53  2 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m15:11:53  2 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.04s]
[0m15:11:53  3 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m15:11:53  3 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m15:11:53  4 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m15:11:53  4 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m15:11:53  5 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m15:11:53  5 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:11:53  6 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m15:11:53  6 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m15:11:53  7 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m15:11:53  7 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:11:53  8 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m15:11:53  8 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:11:53  9 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m15:11:53  9 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m15:11:53  10 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m15:11:53  10 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m15:11:53  11 of 45 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m15:11:53  11 of 45 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m15:11:53  12 of 45 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m15:11:53  12 of 45 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m15:11:53  13 of 45 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m15:11:53  13 of 45 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m15:11:53  14 of 45 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m15:11:53  14 of 45 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.04s]
[0m15:11:53  15 of 45 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m15:11:53  15 of 45 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.05s]
[0m15:11:53  16 of 45 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m15:11:53  16 of 45 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m15:11:53  17 of 45 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m15:11:53  17 of 45 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.04s]
[0m15:11:53  18 of 45 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m15:11:53  18 of 45 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.04s]
[0m15:11:53  19 of 45 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m15:11:53  19 of 45 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m15:11:53  20 of 45 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m15:11:53  20 of 45 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m15:11:53  21 of 45 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m15:11:53  21 of 45 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.04s]
[0m15:11:53  22 of 45 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m15:11:53  22 of 45 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.09s]
[0m15:11:53  23 of 45 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m15:11:53  23 of 45 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m15:11:53  24 of 45 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m15:11:53  24 of 45 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m15:11:53  25 of 45 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m15:11:53  25 of 45 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m15:11:53  26 of 45 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m15:11:54  26 of 45 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m15:11:54  27 of 45 START test not_null_dim_date_date_id .................................. [RUN]
[0m15:11:54  27 of 45 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m15:11:54  28 of 45 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m15:11:54  28 of 45 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m15:11:54  29 of 45 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m15:11:54  29 of 45 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m15:11:54  30 of 45 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m15:11:54  30 of 45 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.04s]
[0m15:11:54  31 of 45 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m15:11:54  31 of 45 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.04s]
[0m15:11:54  32 of 45 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m15:11:54  32 of 45 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.04s]
[0m15:11:54  33 of 45 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m15:11:54  33 of 45 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.04s]
[0m15:11:54  34 of 45 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m15:11:54  34 of 45 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.04s]
[0m15:11:54  35 of 45 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m15:11:54  35 of 45 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.04s]
[0m15:11:54  36 of 45 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m15:11:54  36 of 45 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.04s]
[0m15:11:54  37 of 45 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m15:11:54  37 of 45 FAIL 8190 not_null_fct_flight_bookings_flight_booking_date ............ [[31mFAIL 8190[0m in 0.03s]
[0m15:11:54  38 of 45 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m15:11:54  38 of 45 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m15:11:54  39 of 45 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m15:11:54  39 of 45 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m15:11:54  40 of 45 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m15:11:54  40 of 45 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.03s]
[0m15:11:54  41 of 45 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m15:11:54  41 of 45 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m15:11:54  42 of 45 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m15:11:54  42 of 45 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m15:11:54  43 of 45 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m15:11:54  43 of 45 FAIL 217 not_null_fct_hotel_bookings_hotel_booking_date ............... [[31mFAIL 217[0m in 0.03s]
[0m15:11:54  44 of 45 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m15:11:54  44 of 45 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m15:11:54  45 of 45 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m15:11:54  45 of 45 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m15:11:54  
[0m15:11:54  Running dbt Constraints
[0m15:11:54  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:11:54  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:11:54  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:11:54  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:11:54  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:11:54  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:11:54  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:11:54  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:11:54  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m15:11:55  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:11:55  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:11:55  Creating not null constraint for: aircraft_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: airline_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: arrival_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: departure_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: departure_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating not null constraint for: check_in_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: check_out_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: hotel_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:11:55  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m15:11:55  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:11:55  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m15:11:55  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:11:55  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m15:11:55  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:11:55  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m15:11:55  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m15:11:55  Creating primary key: DIM_DATE_DATE_ID_PK
[0m15:11:55  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:11:55  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m15:11:55  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:11:55  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m15:11:55  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:11:55  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_aircrafts" ['nk_aircraft_id']
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airlines" ['nk_airline_id']
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:11:55  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:11:55  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:11:55  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:11:55  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:11:55  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_hotel" ['nk_hotel_id']
[0m15:11:55  Finished dbt Constraints
[0m15:11:55  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:11:55  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.91s]
[0m15:11:55  
[0m15:11:55  Finished running 1 project hook, 45 data tests in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m15:11:55  
[0m15:11:55  [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:11:55  
[0m15:11:55  [31mFailure in test not_null_fct_flight_bookings_flight_booking_date (models/marts/core/_core__models.yml)[0m
[0m15:11:55    Got 8190 results, configured to fail if != 0
[0m15:11:55  
[0m15:11:55    compiled code at target/compiled/pactravel/models/marts/core/_core__models.yml/not_null_fct_flight_bookings_flight_booking_date.sql
[0m15:11:55  
[0m15:11:55  [31mFailure in test not_null_fct_hotel_bookings_hotel_booking_date (models/marts/core/_core__models.yml)[0m
[0m15:11:55    Got 217 results, configured to fail if != 0
[0m15:11:55  
[0m15:11:55    compiled code at target/compiled/pactravel/models/marts/core/_core__models.yml/not_null_fct_hotel_bookings_hotel_booking_date.sql
[0m15:11:55  
[0m15:11:55  Done. PASS=44 WARN=0 ERROR=2 SKIP=0 TOTAL=46
2025-01-16 23:11:58,049 - ERROR - Transform to All Dimensions and Fact Tables - FAILED!
2025-01-16 23:11:58,207 - ERROR - Transform Tables - FAILED!
2025-01-16 23:11:58,212 - ERROR - [pid 105995] Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) failed    Transform()
Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 33, in run
    sp.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'cd /home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pactravel && dbt deps && dbt seed && dbt run && dbt snapshot && dbt test' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 80, in run
    raise Exception('Failed Transforming Tables!')
Exception: Failed Transforming Tables!
2025-01-16 23:11:58,248 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:11:58,255 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-01-16 23:11:58,256 - DEBUG - Asking scheduler for work...
2025-01-16 23:11:58,259 - DEBUG - Done
2025-01-16 23:11:58,259 - DEBUG - There are no more tasks to run at this time
2025-01-16 23:11:58,259 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-01-16 23:11:58,260 - DEBUG - There are 1 pending tasks unique to this worker
2025-01-16 23:11:58,260 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-01-16 23:11:58,260 - INFO - Worker Worker(salt=9165843314, workers=1, host=MSI, username=alfayyedh, pid=105995) was stopped. Shutting down Keep-Alive thread
2025-01-16 23:11:58,262 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 ran successfully:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-01-16 23:39:19,761 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-16 23:39:19,902 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-16 23:39:19,914 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-16 23:39:19,922 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-16 23:39:19,936 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-16 23:39:19,958 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-16 23:39:20,052 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-16 23:39:20,059 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-16 23:39:20,059 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-16 23:39:20,075 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-16 23:39:20,075 - INFO - [pid 124677] Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) done      Extract()
2025-01-16 23:39:20,076 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:39:20,079 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-16 23:39:20,079 - DEBUG - Asking scheduler for work...
2025-01-16 23:39:20,082 - DEBUG - Pending tasks: 2
2025-01-16 23:39:20,082 - INFO - [pid 124677] Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) running   Load()
2025-01-16 23:39:20,084 - INFO - Read Load Query - SUCCESS!
2025-01-16 23:39:20,118 - INFO - Read Extracted Data - SUCCESS!
2025-01-16 23:39:20,119 - INFO - Connect to DWH - SUCCESS!
2025-01-16 23:39:20,424 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-16 23:39:20,424 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-16 23:39:20,522 - INFO - Load aircrafts table - SUCCESS!
2025-01-16 23:39:20,579 - INFO - Load airlines table - SUCCESS!
2025-01-16 23:39:20,597 - INFO - Load airports table - SUCCESS!
2025-01-16 23:39:20,670 - INFO - Load customers table - SUCCESS!
2025-01-16 23:39:20,755 - INFO - Load hotel table - SUCCESS!
2025-01-16 23:39:21,502 - INFO - Load flight_bookings table - SUCCESS!
2025-01-16 23:39:21,556 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-16 23:39:21,556 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-16 23:39:22,386 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2025-01-16 23:39:22,389 - INFO - ==================================ENDING LOAD DATA=======================================
2025-01-16 23:39:22,390 - INFO - [pid 124677] Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) done      Load()
2025-01-16 23:39:22,390 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:39:22,395 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-01-16 23:39:22,396 - DEBUG - Asking scheduler for work...
2025-01-16 23:39:22,402 - DEBUG - Pending tasks: 1
2025-01-16 23:39:22,402 - INFO - [pid 124677] Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) running   Transform()
2025-01-16 23:39:22,404 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m15:39:24  Running with dbt=1.9.1
[0m15:39:26  Installing dbt-labs/dbt_utils
[0m15:39:27  Installed from version 1.1.1
[0m15:39:27  Updated version available: 1.3.0
[0m15:39:27  Installing calogica/dbt_date
[0m15:39:27  Installed from version 0.10.0
[0m15:39:27  Updated version available: 0.10.1
[0m15:39:27  Installing calogica/dbt_expectations
[0m15:39:30  Installed from version 0.10.3
[0m15:39:30  Updated version available: 0.10.4
[0m15:39:30  Installing Snowflake-Labs/dbt_constraints
[0m15:39:32  Installed from version 0.6.3
[0m15:39:32  Updated version available: 1.0.4
[0m15:39:32  
[0m15:39:32  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'calogica/dbt_expectations', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m15:39:36  Running with dbt=1.9.1
[0m15:39:36  Registered adapter: postgres=1.8.2
[0m15:39:37  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:39:37  
[0m15:39:37  Concurrency: 1 threads (target='dev')
[0m15:39:37  
[0m15:39:37  1 of 1 START seed file final.dim_date .......................................... [RUN]
[0m15:42:06  1 of 1 OK loaded seed file final.dim_date ...................................... [[32mINSERT 29220[0m in 149.08s]
[0m15:42:06  
[0m15:42:06  Running dbt Constraints
[0m15:42:06  Finished dbt Constraints
[0m15:42:06  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:42:06  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.06s]
[0m15:42:06  
[0m15:42:06  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 29.50 seconds (149.50s).
[0m15:42:06  
[0m15:42:06  [32mCompleted successfully[0m
[0m15:42:06  
[0m15:42:06  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:42:10  Running with dbt=1.9.1
[0m15:42:11  Registered adapter: postgres=1.8.2
[0m15:42:12  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:42:12  
[0m15:42:12  Concurrency: 1 threads (target='dev')
[0m15:42:12  
[0m15:42:12  1 of 15 START sql view model final.stg_pactravel__aircrafts .................... [RUN]
[0m15:42:12  1 of 15 OK created sql view model final.stg_pactravel__aircrafts ............... [[32mCREATE VIEW[0m in 0.20s]
[0m15:42:12  2 of 15 START sql view model final.stg_pactravel__airlines ..................... [RUN]
[0m15:42:12  2 of 15 OK created sql view model final.stg_pactravel__airlines ................ [[32mCREATE VIEW[0m in 0.07s]
[0m15:42:12  3 of 15 START sql view model final.stg_pactravel__airports ..................... [RUN]
[0m15:42:12  3 of 15 OK created sql view model final.stg_pactravel__airports ................ [[32mCREATE VIEW[0m in 0.07s]
[0m15:42:12  4 of 15 START sql view model final.stg_pactravel__customers .................... [RUN]
[0m15:42:12  4 of 15 OK created sql view model final.stg_pactravel__customers ............... [[32mCREATE VIEW[0m in 0.11s]
[0m15:42:12  5 of 15 START sql view model final.stg_pactravel__flight_bookings .............. [RUN]
[0m15:42:12  5 of 15 OK created sql view model final.stg_pactravel__flight_bookings ......... [[32mCREATE VIEW[0m in 0.07s]
[0m15:42:12  6 of 15 START sql view model final.stg_pactravel__hotel ........................ [RUN]
[0m15:42:12  6 of 15 OK created sql view model final.stg_pactravel__hotel ................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:42:12  7 of 15 START sql view model final.stg_pactravel__hotel_bookings ............... [RUN]
[0m15:42:12  7 of 15 OK created sql view model final.stg_pactravel__hotel_bookings .......... [[32mCREATE VIEW[0m in 0.13s]
[0m15:42:12  8 of 15 START sql table model final.dim_aircrafts .............................. [RUN]
[0m15:42:13  8 of 15 OK created sql table model final.dim_aircrafts ......................... [[32mSELECT 246[0m in 0.14s]
[0m15:42:13  9 of 15 START sql table model final.dim_airlines ............................... [RUN]
[0m15:42:13  9 of 15 OK created sql table model final.dim_airlines .......................... [[32mSELECT 1251[0m in 0.10s]
[0m15:42:13  10 of 15 START sql table model final.dim_airports .............................. [RUN]
[0m15:42:13  10 of 15 OK created sql table model final.dim_airports ......................... [[32mSELECT 105[0m in 0.09s]
[0m15:42:13  11 of 15 START sql table model final.dim_customers ............................. [RUN]
[0m15:42:13  11 of 15 OK created sql table model final.dim_customers ........................ [[32mSELECT 1000[0m in 0.09s]
[0m15:42:13  12 of 15 START sql table model final.dim_hotel ................................. [RUN]
[0m15:42:13  12 of 15 OK created sql table model final.dim_hotel ............................ [[32mSELECT 1470[0m in 0.11s]
[0m15:42:13  13 of 15 START sql table model final.fct_daily_bookings ........................ [RUN]
[0m15:42:13  13 of 15 OK created sql table model final.fct_daily_bookings ................... [[32mSELECT 0[0m in 0.07s]
[0m15:42:13  14 of 15 START sql table model final.fct_flight_bookings ....................... [RUN]
[0m15:42:14  14 of 15 OK created sql table model final.fct_flight_bookings .................. [[32mSELECT 8190[0m in 0.87s]
[0m15:42:14  15 of 15 START sql table model final.fct_hotel_bookings ........................ [RUN]
[0m15:42:15  15 of 15 OK created sql table model final.fct_hotel_bookings ................... [[32mSELECT 217[0m in 1.00s]
[0m15:42:15  
[0m15:42:15  Running dbt Constraints
[0m15:42:15  Finished dbt Constraints
[0m15:42:15  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:42:15  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.06s]
[0m15:42:15  
[0m15:42:15  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m15:42:15  
[0m15:42:15  [32mCompleted successfully[0m
[0m15:42:15  
[0m15:42:15  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m15:42:19  Running with dbt=1.9.1
[0m15:42:19  Registered adapter: postgres=1.8.2
[0m15:42:19  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:42:19  
[0m15:42:19  Concurrency: 1 threads (target='dev')
[0m15:42:19  
[0m15:42:20  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m15:42:20  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mINSERT 0 1251[0m in 0.27s]
[0m15:42:20  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m15:42:20  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mINSERT 0 1000[0m in 0.12s]
[0m15:42:20  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m15:42:20  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mINSERT 0 1470[0m in 0.16s]
[0m15:42:20  
[0m15:42:20  Running dbt Constraints
[0m15:42:20  Finished dbt Constraints
[0m15:42:20  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:42:20  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m15:42:20  
[0m15:42:20  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m15:42:20  
[0m15:42:20  [32mCompleted successfully[0m
[0m15:42:20  
[0m15:42:20  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:42:24  Running with dbt=1.9.1
[0m15:42:24  Registered adapter: postgres=1.8.2
[0m15:42:24  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:42:24  
[0m15:42:24  Concurrency: 1 threads (target='dev')
[0m15:42:24  
[0m15:42:25  1 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m15:42:25  1 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.07s]
[0m15:42:25  2 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m15:42:25  2 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m15:42:25  3 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m15:42:25  3 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m15:42:25  4 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m15:42:25  4 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m15:42:25  5 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m15:42:25  5 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:42:25  6 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m15:42:25  6 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.05s]
[0m15:42:25  7 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m15:42:25  7 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.05s]
[0m15:42:25  8 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m15:42:25  8 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:42:25  9 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m15:42:25  9 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m15:42:25  10 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m15:42:25  10 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.04s]
[0m15:42:25  11 of 45 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m15:42:25  11 of 45 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.04s]
[0m15:42:25  12 of 45 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m15:42:25  12 of 45 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m15:42:25  13 of 45 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m15:42:25  13 of 45 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m15:42:25  14 of 45 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m15:42:25  14 of 45 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m15:42:25  15 of 45 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m15:42:25  15 of 45 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.05s]
[0m15:42:25  16 of 45 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m15:42:25  16 of 45 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m15:42:25  17 of 45 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m15:42:25  17 of 45 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.04s]
[0m15:42:25  18 of 45 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m15:42:25  18 of 45 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m15:42:25  19 of 45 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m15:42:25  19 of 45 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m15:42:25  20 of 45 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m15:42:25  20 of 45 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m15:42:25  21 of 45 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m15:42:26  21 of 45 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.08s]
[0m15:42:26  22 of 45 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m15:42:26  22 of 45 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m15:42:26  23 of 45 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m15:42:26  23 of 45 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m15:42:26  24 of 45 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m15:42:26  24 of 45 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m15:42:26  25 of 45 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m15:42:26  25 of 45 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m15:42:26  26 of 45 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m15:42:26  26 of 45 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m15:42:26  27 of 45 START test not_null_dim_date_date_id .................................. [RUN]
[0m15:42:26  27 of 45 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m15:42:26  28 of 45 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m15:42:26  28 of 45 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m15:42:26  29 of 45 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m15:42:26  29 of 45 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m15:42:26  30 of 45 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m15:42:26  30 of 45 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m15:42:26  31 of 45 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m15:42:26  31 of 45 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m15:42:26  32 of 45 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m15:42:26  32 of 45 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.03s]
[0m15:42:26  33 of 45 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m15:42:26  33 of 45 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m15:42:26  34 of 45 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m15:42:26  34 of 45 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m15:42:26  35 of 45 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m15:42:26  35 of 45 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m15:42:26  36 of 45 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m15:42:26  36 of 45 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m15:42:26  37 of 45 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m15:42:26  37 of 45 FAIL 8190 not_null_fct_flight_bookings_flight_booking_date ............ [[31mFAIL 8190[0m in 0.03s]
[0m15:42:26  38 of 45 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m15:42:26  38 of 45 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m15:42:26  39 of 45 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m15:42:26  39 of 45 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m15:42:26  40 of 45 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m15:42:26  40 of 45 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.03s]
[0m15:42:26  41 of 45 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m15:42:26  41 of 45 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m15:42:26  42 of 45 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m15:42:26  42 of 45 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m15:42:26  43 of 45 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m15:42:26  43 of 45 FAIL 217 not_null_fct_hotel_bookings_hotel_booking_date ............... [[31mFAIL 217[0m in 0.03s]
[0m15:42:26  44 of 45 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m15:42:26  44 of 45 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m15:42:26  45 of 45 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m15:42:26  45 of 45 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m15:42:26  
[0m15:42:26  Running dbt Constraints
[0m15:42:26  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:42:26  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:42:26  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:42:26  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:42:26  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:42:26  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:42:26  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:42:27  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:42:27  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m15:42:27  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:42:27  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:42:27  Creating not null constraint for: aircraft_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: airline_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: arrival_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: departure_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: departure_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating not null constraint for: check_in_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: check_out_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: hotel_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m15:42:27  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m15:42:27  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m15:42:27  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m15:42:27  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m15:42:27  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m15:42:27  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m15:42:27  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m15:42:27  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m15:42:27  Creating primary key: DIM_DATE_DATE_ID_PK
[0m15:42:27  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m15:42:27  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m15:42:27  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m15:42:27  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m15:42:27  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m15:42:27  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_aircrafts" ['nk_aircraft_id']
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airlines" ['nk_airline_id']
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:42:27  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:42:27  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:42:27  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:42:27  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m15:42:27  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_hotel" ['nk_hotel_id']
[0m15:42:27  Finished dbt Constraints
[0m15:42:27  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m15:42:27  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.88s]
[0m15:42:27  
[0m15:42:27  Finished running 1 project hook, 45 data tests in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m15:42:27  
[0m15:42:27  [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:42:27  
[0m15:42:27  [31mFailure in test not_null_fct_flight_bookings_flight_booking_date (models/marts/core/_core__models.yml)[0m
[0m15:42:27    Got 8190 results, configured to fail if != 0
[0m15:42:27  
[0m15:42:27    compiled code at target/compiled/pactravel/models/marts/core/_core__models.yml/not_null_fct_flight_bookings_flight_booking_date.sql
[0m15:42:27  
[0m15:42:27  [31mFailure in test not_null_fct_hotel_bookings_hotel_booking_date (models/marts/core/_core__models.yml)[0m
[0m15:42:27    Got 217 results, configured to fail if != 0
[0m15:42:27  
[0m15:42:27    compiled code at target/compiled/pactravel/models/marts/core/_core__models.yml/not_null_fct_hotel_bookings_hotel_booking_date.sql
[0m15:42:27  
[0m15:42:27  Done. PASS=44 WARN=0 ERROR=2 SKIP=0 TOTAL=46
2025-01-16 23:42:29,939 - ERROR - Transform to All Dimensions and Fact Tables - FAILED!
2025-01-16 23:42:30,121 - ERROR - Transform Tables - FAILED!
2025-01-16 23:42:30,126 - ERROR - [pid 124677] Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) failed    Transform()
Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 33, in run
    sp.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'cd /home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pactravel && dbt deps && dbt seed && dbt run && dbt snapshot && dbt test' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 80, in run
    raise Exception('Failed Transforming Tables!')
Exception: Failed Transforming Tables!
2025-01-16 23:42:30,169 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:42:30,180 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-01-16 23:42:30,180 - DEBUG - Asking scheduler for work...
2025-01-16 23:42:30,185 - DEBUG - Done
2025-01-16 23:42:30,185 - DEBUG - There are no more tasks to run at this time
2025-01-16 23:42:30,185 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-01-16 23:42:30,185 - DEBUG - There are 1 pending tasks unique to this worker
2025-01-16 23:42:30,185 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-01-16 23:42:30,185 - INFO - Worker Worker(salt=1655673113, workers=1, host=MSI, username=alfayyedh, pid=124677) was stopped. Shutting down Keep-Alive thread
2025-01-16 23:42:30,188 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 ran successfully:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-01-16 23:58:41,329 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-16 23:58:41,409 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-16 23:58:41,427 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-16 23:58:41,436 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-16 23:58:41,457 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-16 23:58:41,495 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-16 23:58:41,666 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-16 23:58:41,688 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-16 23:58:41,689 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-16 23:58:41,697 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-16 23:58:41,697 - INFO - [pid 137259] Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) done      Extract()
2025-01-16 23:58:41,701 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:58:41,710 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-16 23:58:41,711 - DEBUG - Asking scheduler for work...
2025-01-16 23:58:41,717 - DEBUG - Pending tasks: 2
2025-01-16 23:58:41,717 - INFO - [pid 137259] Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) running   Load()
2025-01-16 23:58:41,726 - INFO - Read Load Query - SUCCESS!
2025-01-16 23:58:41,798 - INFO - Read Extracted Data - SUCCESS!
2025-01-16 23:58:41,799 - INFO - Connect to DWH - SUCCESS!
2025-01-16 23:58:41,926 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-16 23:58:41,926 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-16 23:58:41,954 - INFO - Load aircrafts table - SUCCESS!
2025-01-16 23:58:41,996 - INFO - Load airlines table - SUCCESS!
2025-01-16 23:58:42,008 - INFO - Load airports table - SUCCESS!
2025-01-16 23:58:42,041 - INFO - Load customers table - SUCCESS!
2025-01-16 23:58:42,099 - INFO - Load hotel table - SUCCESS!
2025-01-16 23:58:42,888 - INFO - Load flight_bookings table - SUCCESS!
2025-01-16 23:58:42,909 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-16 23:58:42,909 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-16 23:58:43,547 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2025-01-16 23:58:43,549 - INFO - ==================================ENDING LOAD DATA=======================================
2025-01-16 23:58:43,550 - INFO - [pid 137259] Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) done      Load()
2025-01-16 23:58:43,550 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-16 23:58:43,553 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-01-16 23:58:43,553 - DEBUG - Asking scheduler for work...
2025-01-16 23:58:43,555 - DEBUG - Pending tasks: 1
2025-01-16 23:58:43,555 - INFO - [pid 137259] Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) running   Transform()
2025-01-16 23:58:43,556 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m15:58:46  Running with dbt=1.9.1
[0m15:58:48  Installing dbt-labs/dbt_utils
[0m15:58:48  Installed from version 1.1.1
[0m15:58:48  Updated version available: 1.3.0
[0m15:58:48  Installing calogica/dbt_date
[0m15:58:49  Installed from version 0.10.0
[0m15:58:49  Updated version available: 0.10.1
[0m15:58:49  Installing calogica/dbt_expectations
[0m15:58:53  Installed from version 0.10.3
[0m15:58:53  Updated version available: 0.10.4
[0m15:58:53  Installing Snowflake-Labs/dbt_constraints
[0m15:58:54  Installed from version 0.6.3
[0m15:58:54  Updated version available: 1.0.4
[0m15:58:54  
[0m15:58:54  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'calogica/dbt_expectations', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m15:58:58  Running with dbt=1.9.1
[0m15:58:58  Registered adapter: postgres=1.8.2
[0m15:58:59  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m15:58:59  
[0m15:58:59  Concurrency: 1 threads (target='dev')
[0m15:58:59  
[0m15:58:59  1 of 1 START seed file final.dim_date .......................................... [RUN]
[0m16:01:28  1 of 1 OK loaded seed file final.dim_date ...................................... [[32mINSERT 29220[0m in 148.51s]
[0m16:01:28  
[0m16:01:28  Running dbt Constraints
[0m16:01:28  Finished dbt Constraints
[0m16:01:28  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:01:28  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.06s]
[0m16:01:28  
[0m16:01:28  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 28.98 seconds (148.98s).
[0m16:01:28  
[0m16:01:28  [32mCompleted successfully[0m
[0m16:01:28  
[0m16:01:28  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:01:31  Running with dbt=1.9.1
[0m16:01:31  Registered adapter: postgres=1.8.2
[0m16:01:32  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:01:32  
[0m16:01:32  Concurrency: 1 threads (target='dev')
[0m16:01:32  
[0m16:01:32  1 of 15 START sql view model final.stg_pactravel__aircrafts .................... [RUN]
[0m16:01:32  1 of 15 OK created sql view model final.stg_pactravel__aircrafts ............... [[32mCREATE VIEW[0m in 0.14s]
[0m16:01:32  2 of 15 START sql view model final.stg_pactravel__airlines ..................... [RUN]
[0m16:01:32  2 of 15 OK created sql view model final.stg_pactravel__airlines ................ [[32mCREATE VIEW[0m in 0.06s]
[0m16:01:32  3 of 15 START sql view model final.stg_pactravel__airports ..................... [RUN]
[0m16:01:32  3 of 15 OK created sql view model final.stg_pactravel__airports ................ [[32mCREATE VIEW[0m in 0.06s]
[0m16:01:32  4 of 15 START sql view model final.stg_pactravel__customers .................... [RUN]
[0m16:01:32  4 of 15 OK created sql view model final.stg_pactravel__customers ............... [[32mCREATE VIEW[0m in 0.05s]
[0m16:01:32  5 of 15 START sql view model final.stg_pactravel__flight_bookings .............. [RUN]
[0m16:01:33  5 of 15 OK created sql view model final.stg_pactravel__flight_bookings ......... [[32mCREATE VIEW[0m in 0.05s]
[0m16:01:33  6 of 15 START sql view model final.stg_pactravel__hotel ........................ [RUN]
[0m16:01:33  6 of 15 OK created sql view model final.stg_pactravel__hotel ................... [[32mCREATE VIEW[0m in 0.05s]
[0m16:01:33  7 of 15 START sql view model final.stg_pactravel__hotel_bookings ............... [RUN]
[0m16:01:33  7 of 15 OK created sql view model final.stg_pactravel__hotel_bookings .......... [[32mCREATE VIEW[0m in 0.05s]
[0m16:01:33  8 of 15 START sql table model final.dim_aircrafts .............................. [RUN]
[0m16:01:33  8 of 15 OK created sql table model final.dim_aircrafts ......................... [[32mSELECT 246[0m in 0.10s]
[0m16:01:33  9 of 15 START sql table model final.dim_airlines ............................... [RUN]
[0m16:01:33  9 of 15 OK created sql table model final.dim_airlines .......................... [[32mSELECT 1251[0m in 0.12s]
[0m16:01:33  10 of 15 START sql table model final.dim_airports .............................. [RUN]
[0m16:01:33  10 of 15 OK created sql table model final.dim_airports ......................... [[32mSELECT 105[0m in 0.06s]
[0m16:01:33  11 of 15 START sql table model final.dim_customers ............................. [RUN]
[0m16:01:33  11 of 15 OK created sql table model final.dim_customers ........................ [[32mSELECT 1000[0m in 0.06s]
[0m16:01:33  12 of 15 START sql table model final.dim_hotel ................................. [RUN]
[0m16:01:33  12 of 15 OK created sql table model final.dim_hotel ............................ [[32mSELECT 1470[0m in 0.07s]
[0m16:01:33  13 of 15 START sql table model final.fct_daily_bookings ........................ [RUN]
[0m16:01:33  13 of 15 ERROR creating sql table model final.fct_daily_bookings ............... [[31mERROR[0m in 0.04s]
[0m16:01:33  14 of 15 START sql table model final.fct_flight_bookings ....................... [RUN]
[0m16:01:33  14 of 15 ERROR creating sql table model final.fct_flight_bookings .............. [[31mERROR[0m in 0.03s]
[0m16:01:33  15 of 15 START sql table model final.fct_hotel_bookings ........................ [RUN]
[0m16:01:33  15 of 15 ERROR creating sql table model final.fct_hotel_bookings ............... [[31mERROR[0m in 0.03s]
[0m16:01:33  
[0m16:01:33  Running dbt Constraints
[0m16:01:33  Finished dbt Constraints
[0m16:01:33  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:01:33  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m16:01:33  
[0m16:01:33  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m16:01:33  
[0m16:01:33  [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:01:33  
[0m16:01:33    Database Error in model fct_daily_bookings (models/marts/core/fct_daily_bookings.sql)
  column shb.hotel_booking_date does not exist
  LINE 29:         date_trunc('day', shb.hotel_booking_date) as hotel_b...
                                     ^
  compiled code at target/run/pactravel/models/marts/core/fct_daily_bookings.sql
[0m16:01:33  
[0m16:01:33    Database Error in model fct_flight_bookings (models/marts/core/fct_flight_bookings.sql)
  column "flight_booking_date" does not exist
  LINE 53:   flight_booking_date
             ^
  compiled code at target/run/pactravel/models/marts/core/fct_flight_bookings.sql
[0m16:01:33  
[0m16:01:33    Database Error in model fct_hotel_bookings (models/marts/core/fct_hotel_bookings.sql)
  column "hotel_booking_date" does not exist
  LINE 47:         hotel_booking_date
                   ^
  compiled code at target/run/pactravel/models/marts/core/fct_hotel_bookings.sql
[0m16:01:33  
[0m16:01:33  Done. PASS=13 WARN=0 ERROR=3 SKIP=0 TOTAL=16
2025-01-17 00:01:35,927 - ERROR - Transform to All Dimensions and Fact Tables - FAILED!
2025-01-17 00:01:36,117 - ERROR - Transform Tables - FAILED!
2025-01-17 00:01:36,121 - ERROR - [pid 137259] Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) failed    Transform()
Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 33, in run
    sp.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'cd /home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pactravel/ && dbt deps && dbt seed && dbt run && dbt snapshot && dbt test' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/.venv/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/alfayyedh/pacmann/data-warehouse/pactravel-dataset/pipeline/transform.py", line 80, in run
    raise Exception('Failed Transforming Tables!')
Exception: Failed Transforming Tables!
2025-01-17 00:01:36,147 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:01:36,153 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-01-17 00:01:36,153 - DEBUG - Asking scheduler for work...
2025-01-17 00:01:36,157 - DEBUG - Done
2025-01-17 00:01:36,157 - DEBUG - There are no more tasks to run at this time
2025-01-17 00:01:36,157 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-01-17 00:01:36,157 - DEBUG - There are 3 pending tasks unique to this worker
2025-01-17 00:01:36,157 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-01-17 00:01:36,157 - INFO - Worker Worker(salt=7539604602, workers=1, host=MSI, username=alfayyedh, pid=137259) was stopped. Shutting down Keep-Alive thread
2025-01-17 00:01:36,158 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 ran successfully:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-01-17 00:32:34,347 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-17 00:32:34,452 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-17 00:32:34,467 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-17 00:32:34,473 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-17 00:32:34,489 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-17 00:32:34,511 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-17 00:32:34,592 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-17 00:32:34,601 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-17 00:32:34,601 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-17 00:32:34,617 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-17 00:32:34,617 - INFO - [pid 158159] Worker Worker(salt=6082957136, workers=1, host=MSI, username=alfayyedh, pid=158159) done      Extract()
2025-01-17 00:32:34,619 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:32:34,623 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-17 00:32:34,623 - DEBUG - Asking scheduler for work...
2025-01-17 00:32:34,625 - DEBUG - Pending tasks: 2
2025-01-17 00:32:34,625 - INFO - [pid 158159] Worker Worker(salt=6082957136, workers=1, host=MSI, username=alfayyedh, pid=158159) running   Load()
2025-01-17 00:32:34,628 - INFO - Read Load Query - SUCCESS!
2025-01-17 00:32:34,674 - INFO - Read Extracted Data - SUCCESS!
2025-01-17 00:32:34,675 - INFO - Connect to DWH - SUCCESS!
2025-01-17 00:32:35,135 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-17 00:32:35,135 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-17 00:32:35,158 - INFO - Load aircrafts table - SUCCESS!
2025-01-17 00:32:35,192 - INFO - Load airlines table - SUCCESS!
2025-01-17 00:32:35,204 - INFO - Load airports table - SUCCESS!
2025-01-17 00:32:35,238 - INFO - Load customers table - SUCCESS!
2025-01-17 00:32:35,302 - INFO - Load hotel table - SUCCESS!
2025-01-17 00:32:35,961 - INFO - Load flight_bookings table - SUCCESS!
2025-01-17 00:32:35,983 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-17 00:32:35,984 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-17 00:32:36,473 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2025-01-17 00:32:36,478 - INFO - ==================================ENDING LOAD DATA=======================================
2025-01-17 00:32:36,479 - INFO - [pid 158159] Worker Worker(salt=6082957136, workers=1, host=MSI, username=alfayyedh, pid=158159) done      Load()
2025-01-17 00:32:36,479 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:32:36,483 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-01-17 00:32:36,484 - DEBUG - Asking scheduler for work...
2025-01-17 00:32:36,487 - DEBUG - Pending tasks: 1
2025-01-17 00:32:36,488 - INFO - [pid 158159] Worker Worker(salt=6082957136, workers=1, host=MSI, username=alfayyedh, pid=158159) running   Transform()
2025-01-17 00:32:36,488 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-01-17 00:32:37,914 - INFO - Worker Worker(salt=6082957136, workers=1, host=MSI, username=alfayyedh, pid=158159) was stopped. Shutting down Keep-Alive thread
[0m16:41:46  Running with dbt=1.9.1
[0m16:41:48  Installing dbt-labs/dbt_utils
[0m16:41:49  Installed from version 1.1.1
[0m16:41:49  Updated version available: 1.3.0
[0m16:41:49  Installing calogica/dbt_date
[0m16:41:49  Installed from version 0.10.0
[0m16:41:49  Updated version available: 0.10.1
[0m16:41:49  Installing calogica/dbt_expectations
[0m16:41:51  Installed from version 0.10.3
[0m16:41:51  Updated version available: 0.10.4
[0m16:41:51  Installing Snowflake-Labs/dbt_constraints
[0m16:41:52  Installed from version 0.6.3
[0m16:41:52  Updated version available: 1.0.4
[0m16:41:52  
[0m16:41:52  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'calogica/dbt_expectations', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m16:41:55  Running with dbt=1.9.1
[0m16:41:55  Registered adapter: postgres=1.8.2
[0m16:41:56  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:41:56  
[0m16:41:56  Concurrency: 1 threads (target='dev')
[0m16:41:56  
[0m16:41:56  1 of 1 START seed file final.dim_date .......................................... [RUN]
[0m16:44:28  1 of 1 OK loaded seed file final.dim_date ...................................... [[32mINSERT 29220[0m in 151.82s]
[0m16:44:28  
[0m16:44:28  Running dbt Constraints
[0m16:44:28  Finished dbt Constraints
[0m16:44:28  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:44:28  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.07s]
[0m16:44:28  
[0m16:44:28  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 32.21 seconds (152.21s).
[0m16:44:28  
[0m16:44:28  [32mCompleted successfully[0m
[0m16:44:28  
[0m16:44:28  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:44:32  Running with dbt=1.9.1
[0m16:44:32  Registered adapter: postgres=1.8.2
[0m16:44:33  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:44:33  
[0m16:44:33  Concurrency: 1 threads (target='dev')
[0m16:44:33  
[0m16:44:33  1 of 15 START sql view model final.stg_pactravel__aircrafts .................... [RUN]
[0m16:44:33  1 of 15 OK created sql view model final.stg_pactravel__aircrafts ............... [[32mCREATE VIEW[0m in 0.13s]
[0m16:44:33  2 of 15 START sql view model final.stg_pactravel__airlines ..................... [RUN]
[0m16:44:33  2 of 15 OK created sql view model final.stg_pactravel__airlines ................ [[32mCREATE VIEW[0m in 0.06s]
[0m16:44:33  3 of 15 START sql view model final.stg_pactravel__airports ..................... [RUN]
[0m16:44:33  3 of 15 OK created sql view model final.stg_pactravel__airports ................ [[32mCREATE VIEW[0m in 0.06s]
[0m16:44:33  4 of 15 START sql view model final.stg_pactravel__customers .................... [RUN]
[0m16:44:33  4 of 15 OK created sql view model final.stg_pactravel__customers ............... [[32mCREATE VIEW[0m in 0.07s]
[0m16:44:33  5 of 15 START sql view model final.stg_pactravel__flight_bookings .............. [RUN]
[0m16:44:33  5 of 15 OK created sql view model final.stg_pactravel__flight_bookings ......... [[32mCREATE VIEW[0m in 0.08s]
[0m16:44:33  6 of 15 START sql view model final.stg_pactravel__hotel ........................ [RUN]
[0m16:44:33  6 of 15 OK created sql view model final.stg_pactravel__hotel ................... [[32mCREATE VIEW[0m in 0.06s]
[0m16:44:33  7 of 15 START sql view model final.stg_pactravel__hotel_bookings ............... [RUN]
[0m16:44:33  7 of 15 OK created sql view model final.stg_pactravel__hotel_bookings .......... [[32mCREATE VIEW[0m in 0.06s]
[0m16:44:33  8 of 15 START sql table model final.dim_aircrafts .............................. [RUN]
[0m16:44:33  8 of 15 OK created sql table model final.dim_aircrafts ......................... [[32mSELECT 0[0m in 0.12s]
[0m16:44:33  9 of 15 START sql table model final.dim_airlines ............................... [RUN]
[0m16:44:33  9 of 15 OK created sql table model final.dim_airlines .......................... [[32mSELECT 0[0m in 0.11s]
[0m16:44:33  10 of 15 START sql table model final.dim_airports .............................. [RUN]
[0m16:44:34  10 of 15 OK created sql table model final.dim_airports ......................... [[32mSELECT 0[0m in 0.06s]
[0m16:44:34  11 of 15 START sql table model final.dim_customers ............................. [RUN]
[0m16:44:34  11 of 15 OK created sql table model final.dim_customers ........................ [[32mSELECT 0[0m in 0.06s]
[0m16:44:34  12 of 15 START sql table model final.dim_hotel ................................. [RUN]
[0m16:44:34  12 of 15 OK created sql table model final.dim_hotel ............................ [[32mSELECT 0[0m in 0.07s]
[0m16:44:34  13 of 15 START sql table model final.fct_daily_bookings ........................ [RUN]
[0m16:44:34  13 of 15 OK created sql table model final.fct_daily_bookings ................... [[32mSELECT 0[0m in 0.06s]
[0m16:44:34  14 of 15 START sql table model final.fct_flight_bookings ....................... [RUN]
[0m16:44:35  14 of 15 OK created sql table model final.fct_flight_bookings .................. [[32mSELECT 0[0m in 0.80s]
[0m16:44:35  15 of 15 START sql table model final.fct_hotel_bookings ........................ [RUN]
[0m16:44:35  15 of 15 OK created sql table model final.fct_hotel_bookings ................... [[32mSELECT 0[0m in 0.80s]
[0m16:44:35  
[0m16:44:35  Running dbt Constraints
[0m16:44:35  Finished dbt Constraints
[0m16:44:35  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:44:35  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.07s]
[0m16:44:35  
[0m16:44:35  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m16:44:36  
[0m16:44:36  [32mCompleted successfully[0m
[0m16:44:36  
[0m16:44:36  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m16:44:39  Running with dbt=1.9.1
[0m16:44:39  Registered adapter: postgres=1.8.2
[0m16:44:40  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:44:40  
[0m16:44:40  Concurrency: 1 threads (target='dev')
[0m16:44:40  
[0m16:44:40  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m16:44:40  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mSELECT 0[0m in 0.13s]
[0m16:44:40  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m16:44:40  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mSELECT 0[0m in 0.04s]
[0m16:44:40  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m16:44:40  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mSELECT 0[0m in 0.04s]
[0m16:44:40  
[0m16:44:41  Running dbt Constraints
[0m16:44:41  Finished dbt Constraints
[0m16:44:41  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:44:41  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m16:44:41  
[0m16:44:41  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:44:41  
[0m16:44:41  [32mCompleted successfully[0m
[0m16:44:41  
[0m16:44:41  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:44:44  Running with dbt=1.9.1
[0m16:44:44  Registered adapter: postgres=1.8.2
[0m16:44:45  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:44:45  
[0m16:44:45  Concurrency: 1 threads (target='dev')
[0m16:44:45  
[0m16:44:45  1 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m16:44:45  1 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.07s]
[0m16:44:45  2 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m16:44:45  2 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m16:44:45  3 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m16:44:45  3 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m16:44:45  4 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m16:44:45  4 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m16:44:45  5 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m16:44:45  5 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m16:44:45  6 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m16:44:45  6 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m16:44:45  7 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m16:44:45  7 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m16:44:45  8 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m16:44:45  8 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m16:44:45  9 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m16:44:45  9 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.06s]
[0m16:44:45  10 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m16:44:45  10 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.04s]
[0m16:44:45  11 of 45 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m16:44:45  11 of 45 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m16:44:45  12 of 45 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m16:44:45  12 of 45 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m16:44:45  13 of 45 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m16:44:45  13 of 45 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m16:44:45  14 of 45 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m16:44:45  14 of 45 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m16:44:45  15 of 45 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m16:44:45  15 of 45 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m16:44:45  16 of 45 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m16:44:45  16 of 45 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m16:44:45  17 of 45 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m16:44:45  17 of 45 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.03s]
[0m16:44:45  18 of 45 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m16:44:45  18 of 45 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m16:44:45  19 of 45 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m16:44:45  19 of 45 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m16:44:45  20 of 45 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m16:44:45  20 of 45 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m16:44:45  21 of 45 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m16:44:46  21 of 45 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.08s]
[0m16:44:46  22 of 45 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m16:44:46  22 of 45 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m16:44:46  23 of 45 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m16:44:46  23 of 45 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m16:44:46  24 of 45 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m16:44:46  24 of 45 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m16:44:46  25 of 45 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m16:44:46  25 of 45 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m16:44:46  26 of 45 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m16:44:46  26 of 45 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m16:44:46  27 of 45 START test not_null_dim_date_date_id .................................. [RUN]
[0m16:44:46  27 of 45 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m16:44:46  28 of 45 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m16:44:46  28 of 45 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m16:44:46  29 of 45 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m16:44:46  29 of 45 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.04s]
[0m16:44:46  30 of 45 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m16:44:46  30 of 45 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m16:44:46  31 of 45 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m16:44:46  31 of 45 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m16:44:46  32 of 45 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m16:44:46  32 of 45 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.03s]
[0m16:44:46  33 of 45 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m16:44:46  33 of 45 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m16:44:46  34 of 45 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m16:44:46  34 of 45 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m16:44:46  35 of 45 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m16:44:46  35 of 45 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m16:44:46  36 of 45 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m16:44:46  36 of 45 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m16:44:46  37 of 45 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m16:44:46  37 of 45 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.04s]
[0m16:44:46  38 of 45 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m16:44:46  38 of 45 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.04s]
[0m16:44:46  39 of 45 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m16:44:46  39 of 45 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.04s]
[0m16:44:46  40 of 45 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m16:44:46  40 of 45 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.04s]
[0m16:44:46  41 of 45 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m16:44:46  41 of 45 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m16:44:46  42 of 45 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m16:44:46  42 of 45 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m16:44:46  43 of 45 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m16:44:46  43 of 45 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.03s]
[0m16:44:46  44 of 45 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m16:44:46  44 of 45 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m16:44:46  45 of 45 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m16:44:46  45 of 45 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m16:44:46  
[0m16:44:46  Running dbt Constraints
[0m16:44:47  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:44:47  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:44:47  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:44:47  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:44:47  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:44:47  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:44:47  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:44:47  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:44:47  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m16:44:47  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:44:47  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:44:47  Creating not null constraint for: aircraft_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: airline_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: arrival_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: departure_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: departure_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating not null constraint for: check_in_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: check_out_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: hotel_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:44:47  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m16:44:47  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:44:47  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m16:44:47  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:44:47  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m16:44:47  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:44:47  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m16:44:47  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m16:44:47  Creating primary key: DIM_DATE_DATE_ID_PK
[0m16:44:47  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:44:47  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m16:44:47  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:44:47  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m16:44:47  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:44:47  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_aircrafts" ['nk_aircraft_id']
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airlines" ['nk_airline_id']
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:44:47  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:44:47  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:44:47  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:44:47  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:44:47  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_hotel" ['nk_hotel_id']
[0m16:44:47  Finished dbt Constraints
[0m16:44:47  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:44:47  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 1.00s]
[0m16:44:47  
[0m16:44:47  Finished running 1 project hook, 45 data tests in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m16:44:48  
[0m16:44:48  [32mCompleted successfully[0m
[0m16:44:48  
[0m16:44:48  Done. PASS=46 WARN=0 ERROR=0 SKIP=0 TOTAL=46
2025-01-17 00:47:53,332 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-01-17 00:47:53,379 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2025-01-17 00:47:53,390 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2025-01-17 00:47:53,395 - INFO - EXTRACT 'public.airports' - SUCCESS.
2025-01-17 00:47:53,404 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-01-17 00:47:53,422 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2025-01-17 00:47:53,494 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2025-01-17 00:47:53,501 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2025-01-17 00:47:53,501 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2025-01-17 00:47:53,503 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-01-17 00:47:53,504 - INFO - [pid 169117] Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) done      Extract()
2025-01-17 00:47:53,504 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:47:53,507 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-01-17 00:47:53,507 - DEBUG - Asking scheduler for work...
2025-01-17 00:47:53,509 - DEBUG - Pending tasks: 2
2025-01-17 00:47:53,509 - INFO - [pid 169117] Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) running   Load()
2025-01-17 00:47:53,513 - INFO - Read Load Query - SUCCESS!
2025-01-17 00:47:53,553 - INFO - Read Extracted Data - SUCCESS!
2025-01-17 00:47:53,554 - INFO - Connect to DWH - SUCCESS!
2025-01-17 00:47:53,666 - INFO - Truncate public Schema in DWH - SUCCESS!
2025-01-17 00:47:53,666 - INFO - ==================================STARTING LOAD DATA=======================================
2025-01-17 00:47:53,690 - INFO - Load aircrafts table - SUCCESS!
2025-01-17 00:47:53,737 - INFO - Load airlines table - SUCCESS!
2025-01-17 00:47:53,749 - INFO - Load airports table - SUCCESS!
2025-01-17 00:47:53,788 - INFO - Load customers table - SUCCESS!
2025-01-17 00:47:53,840 - INFO - Load hotel table - SUCCESS!
2025-01-17 00:47:54,510 - INFO - Load flight_bookings table - SUCCESS!
2025-01-17 00:47:54,528 - INFO - Load hotel_bookings table - SUCCESS!
2025-01-17 00:47:54,529 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2025-01-17 00:47:54,943 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2025-01-17 00:47:54,945 - INFO - ==================================ENDING LOAD DATA=======================================
2025-01-17 00:47:54,946 - INFO - [pid 169117] Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) done      Load()
2025-01-17 00:47:54,946 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:47:54,949 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-01-17 00:47:54,949 - DEBUG - Asking scheduler for work...
2025-01-17 00:47:54,951 - DEBUG - Pending tasks: 1
2025-01-17 00:47:54,951 - INFO - [pid 169117] Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) running   Transform()
2025-01-17 00:47:54,952 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m16:47:56  Running with dbt=1.9.1
[0m16:47:58  Installing dbt-labs/dbt_utils
[0m16:47:58  Installed from version 1.1.1
[0m16:47:58  Updated version available: 1.3.0
[0m16:47:58  Installing calogica/dbt_date
[0m16:47:59  Installed from version 0.10.0
[0m16:47:59  Updated version available: 0.10.1
[0m16:47:59  Installing calogica/dbt_expectations
[0m16:48:01  Installed from version 0.10.3
[0m16:48:01  Updated version available: 0.10.4
[0m16:48:01  Installing Snowflake-Labs/dbt_constraints
[0m16:48:02  Installed from version 0.6.3
[0m16:48:02  Updated version available: 1.0.4
[0m16:48:02  
[0m16:48:02  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'calogica/dbt_expectations', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m16:48:05  Running with dbt=1.9.1
[0m16:48:06  Registered adapter: postgres=1.8.2
[0m16:48:06  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:48:06  
[0m16:48:06  Concurrency: 1 threads (target='dev')
[0m16:48:06  
[0m16:48:06  1 of 1 START seed file final.dim_date .......................................... [RUN]
[0m16:50:31  1 of 1 OK loaded seed file final.dim_date ...................................... [[32mINSERT 29220[0m in 144.36s]
[0m16:50:31  
[0m16:50:31  Running dbt Constraints
[0m16:50:31  Finished dbt Constraints
[0m16:50:31  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:50:31  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.08s]
[0m16:50:31  
[0m16:50:31  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 24.62 seconds (144.62s).
[0m16:50:31  
[0m16:50:31  [32mCompleted successfully[0m
[0m16:50:31  
[0m16:50:31  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:50:34  Running with dbt=1.9.1
[0m16:50:35  Registered adapter: postgres=1.8.2
[0m16:50:35  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:50:35  
[0m16:50:35  Concurrency: 1 threads (target='dev')
[0m16:50:35  
[0m16:50:36  1 of 15 START sql view model final.stg_pactravel__aircrafts .................... [RUN]
[0m16:50:36  1 of 15 OK created sql view model final.stg_pactravel__aircrafts ............... [[32mCREATE VIEW[0m in 0.16s]
[0m16:50:36  2 of 15 START sql view model final.stg_pactravel__airlines ..................... [RUN]
[0m16:50:36  2 of 15 OK created sql view model final.stg_pactravel__airlines ................ [[32mCREATE VIEW[0m in 0.07s]
[0m16:50:36  3 of 15 START sql view model final.stg_pactravel__airports ..................... [RUN]
[0m16:50:36  3 of 15 OK created sql view model final.stg_pactravel__airports ................ [[32mCREATE VIEW[0m in 0.08s]
[0m16:50:36  4 of 15 START sql view model final.stg_pactravel__customers .................... [RUN]
[0m16:50:36  4 of 15 OK created sql view model final.stg_pactravel__customers ............... [[32mCREATE VIEW[0m in 0.10s]
[0m16:50:36  5 of 15 START sql view model final.stg_pactravel__flight_bookings .............. [RUN]
[0m16:50:36  5 of 15 OK created sql view model final.stg_pactravel__flight_bookings ......... [[32mCREATE VIEW[0m in 0.11s]
[0m16:50:36  6 of 15 START sql view model final.stg_pactravel__hotel ........................ [RUN]
[0m16:50:36  6 of 15 OK created sql view model final.stg_pactravel__hotel ................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:50:36  7 of 15 START sql view model final.stg_pactravel__hotel_bookings ............... [RUN]
[0m16:50:36  7 of 15 OK created sql view model final.stg_pactravel__hotel_bookings .......... [[32mCREATE VIEW[0m in 0.13s]
[0m16:50:36  8 of 15 START sql table model final.dim_aircrafts .............................. [RUN]
[0m16:50:36  8 of 15 OK created sql table model final.dim_aircrafts ......................... [[32mSELECT 246[0m in 0.13s]
[0m16:50:36  9 of 15 START sql table model final.dim_airlines ............................... [RUN]
[0m16:50:37  9 of 15 OK created sql table model final.dim_airlines .......................... [[32mSELECT 1251[0m in 0.09s]
[0m16:50:37  10 of 15 START sql table model final.dim_airports .............................. [RUN]
[0m16:50:37  10 of 15 OK created sql table model final.dim_airports ......................... [[32mSELECT 105[0m in 0.08s]
[0m16:50:37  11 of 15 START sql table model final.dim_customers ............................. [RUN]
[0m16:50:37  11 of 15 OK created sql table model final.dim_customers ........................ [[32mSELECT 1000[0m in 0.09s]
[0m16:50:37  12 of 15 START sql table model final.dim_hotel ................................. [RUN]
[0m16:50:37  12 of 15 OK created sql table model final.dim_hotel ............................ [[32mSELECT 1470[0m in 0.10s]
[0m16:50:37  13 of 15 START sql table model final.fct_daily_bookings ........................ [RUN]
[0m16:50:37  13 of 15 OK created sql table model final.fct_daily_bookings ................... [[32mSELECT 2397[0m in 0.10s]
[0m16:50:37  14 of 15 START sql table model final.fct_flight_bookings ....................... [RUN]
[0m16:50:38  14 of 15 OK created sql table model final.fct_flight_bookings .................. [[32mSELECT 8190[0m in 1.55s]
[0m16:50:38  15 of 15 START sql table model final.fct_hotel_bookings ........................ [RUN]
[0m16:50:39  15 of 15 OK created sql table model final.fct_hotel_bookings ................... [[32mSELECT 217[0m in 0.82s]
[0m16:50:39  
[0m16:50:39  Running dbt Constraints
[0m16:50:39  Finished dbt Constraints
[0m16:50:39  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:50:39  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m16:50:39  
[0m16:50:39  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m16:50:39  
[0m16:50:39  [32mCompleted successfully[0m
[0m16:50:39  
[0m16:50:39  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m16:50:43  Running with dbt=1.9.1
[0m16:50:43  Registered adapter: postgres=1.8.2
[0m16:50:44  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:50:44  
[0m16:50:44  Concurrency: 1 threads (target='dev')
[0m16:50:44  
[0m16:50:44  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m16:50:44  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mINSERT 0 1251[0m in 0.24s]
[0m16:50:44  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m16:50:44  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mINSERT 0 1000[0m in 0.13s]
[0m16:50:44  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m16:50:44  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mINSERT 0 1470[0m in 0.11s]
[0m16:50:44  
[0m16:50:44  Running dbt Constraints
[0m16:50:44  Finished dbt Constraints
[0m16:50:44  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:50:44  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m16:50:44  
[0m16:50:44  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m16:50:44  
[0m16:50:44  [32mCompleted successfully[0m
[0m16:50:44  
[0m16:50:44  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:50:47  Running with dbt=1.9.1
[0m16:50:48  Registered adapter: postgres=1.8.2
[0m16:50:48  Found 15 models, 3 snapshots, 1 seed, 1 operation, 45 data tests, 7 sources, 888 macros
[0m16:50:48  
[0m16:50:48  Concurrency: 1 threads (target='dev')
[0m16:50:48  
[0m16:50:49  1 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m16:50:49  1 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.09s]
[0m16:50:49  2 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m16:50:49  2 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m16:50:49  3 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m16:50:49  3 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.04s]
[0m16:50:49  4 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m16:50:49  4 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m16:50:49  5 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m16:50:49  5 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m16:50:49  6 of 45 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m16:50:49  6 of 45 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m16:50:49  7 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m16:50:49  7 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m16:50:49  8 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m16:50:49  8 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m16:50:49  9 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m16:50:49  9 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m16:50:49  10 of 45 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m16:50:49  10 of 45 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m16:50:49  11 of 45 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m16:50:49  11 of 45 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m16:50:49  12 of 45 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m16:50:49  12 of 45 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m16:50:49  13 of 45 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m16:50:49  13 of 45 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m16:50:49  14 of 45 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m16:50:49  14 of 45 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m16:50:49  15 of 45 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m16:50:49  15 of 45 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m16:50:49  16 of 45 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m16:50:49  16 of 45 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m16:50:49  17 of 45 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m16:50:49  17 of 45 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.03s]
[0m16:50:49  18 of 45 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m16:50:49  18 of 45 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m16:50:49  19 of 45 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m16:50:49  19 of 45 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.04s]
[0m16:50:49  20 of 45 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m16:50:49  20 of 45 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m16:50:49  21 of 45 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m16:50:49  21 of 45 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.10s]
[0m16:50:49  22 of 45 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m16:50:49  22 of 45 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m16:50:49  23 of 45 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m16:50:50  23 of 45 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m16:50:50  24 of 45 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m16:50:50  24 of 45 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m16:50:50  25 of 45 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m16:50:50  25 of 45 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m16:50:50  26 of 45 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m16:50:50  26 of 45 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.06s]
[0m16:50:50  27 of 45 START test not_null_dim_date_date_id .................................. [RUN]
[0m16:50:50  27 of 45 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.05s]
[0m16:50:50  28 of 45 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m16:50:50  28 of 45 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m16:50:50  29 of 45 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m16:50:50  29 of 45 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.04s]
[0m16:50:50  30 of 45 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m16:50:50  30 of 45 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.04s]
[0m16:50:50  31 of 45 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m16:50:50  31 of 45 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m16:50:50  32 of 45 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m16:50:50  32 of 45 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.03s]
[0m16:50:50  33 of 45 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m16:50:50  33 of 45 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m16:50:50  34 of 45 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m16:50:50  34 of 45 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m16:50:50  35 of 45 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m16:50:50  35 of 45 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m16:50:50  36 of 45 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m16:50:50  36 of 45 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m16:50:50  37 of 45 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m16:50:50  37 of 45 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.03s]
[0m16:50:50  38 of 45 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m16:50:50  38 of 45 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m16:50:50  39 of 45 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m16:50:50  39 of 45 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m16:50:50  40 of 45 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m16:50:50  40 of 45 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.03s]
[0m16:50:50  41 of 45 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m16:50:50  41 of 45 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m16:50:50  42 of 45 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m16:50:50  42 of 45 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m16:50:50  43 of 45 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m16:50:50  43 of 45 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.03s]
[0m16:50:50  44 of 45 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m16:50:50  44 of 45 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m16:50:50  45 of 45 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m16:50:50  45 of 45 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m16:50:50  
[0m16:50:50  Running dbt Constraints
[0m16:50:50  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:50:50  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:50:50  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:50:50  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:50:50  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:50:50  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:50:50  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:50:50  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:50:51  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m16:50:51  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:50:51  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:50:51  Creating not null constraint for: aircraft_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: airline_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: arrival_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: departure_airport in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: departure_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating not null constraint for: check_in_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: check_out_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: hotel_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."final"."dim_aircrafts"
[0m16:50:51  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m16:50:51  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."final"."dim_airlines"
[0m16:50:51  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m16:50:51  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."final"."dim_airports"
[0m16:50:51  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m16:50:51  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."final"."dim_customers"
[0m16:50:51  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m16:50:51  Creating not null constraint for: date_id in "pactravel-dwh"."final"."dim_date"
[0m16:50:51  Creating primary key: DIM_DATE_DATE_ID_PK
[0m16:50:51  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."final"."dim_hotel"
[0m16:50:51  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m16:50:51  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."final"."fct_flight_bookings"
[0m16:50:51  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m16:50:51  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."final"."fct_hotel_bookings"
[0m16:50:51  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_aircrafts" ['nk_aircraft_id']
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airlines" ['nk_airline_id']
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_airports" ['airport_name']
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:50:51  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:50:51  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:50:51  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:50:51  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_date" ['date_actual']
[0m16:50:51  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."final"."dim_hotel" ['nk_hotel_id']
[0m16:50:51  Finished dbt Constraints
[0m16:50:51  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m16:50:51  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.91s]
[0m16:50:51  
[0m16:50:51  Finished running 1 project hook, 45 data tests in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m16:50:51  
[0m16:50:51  [32mCompleted successfully[0m
[0m16:50:51  
[0m16:50:51  Done. PASS=46 WARN=0 ERROR=0 SKIP=0 TOTAL=46
2025-01-17 00:50:53,933 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2025-01-17 00:50:53,933 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2025-01-17 00:50:53,933 - INFO - [pid 169117] Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) done      Transform()
2025-01-17 00:50:53,934 - DEBUG - 1 running tasks, waiting for next task to finish
2025-01-17 00:50:53,937 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-01-17 00:50:53,937 - DEBUG - Asking scheduler for work...
2025-01-17 00:50:53,940 - DEBUG - Done
2025-01-17 00:50:53,940 - DEBUG - There are no more tasks to run at this time
2025-01-17 00:50:53,940 - INFO - Worker Worker(salt=111939101, workers=1, host=MSI, username=alfayyedh, pid=169117) was stopped. Shutting down Keep-Alive thread
2025-01-17 00:50:53,941 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

